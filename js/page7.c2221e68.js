(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["page7"],{"07e4":function(t,i,e){},"74f1":function(t,i,e){"use strict";e("07e4")},"81d8":function(t,i,e){"use strict";e("c2dd")},8323:function(t,i,e){"use strict";e.r(i);var n=function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("v-sheet",{staticClass:"playing-bar",attrs:{tag:"header",elevation:"2"}},[e("v-row",{staticClass:"ml-0 mr-0 now-playing-bar",attrs:{justify:"space-between"}},[e("v-col",{staticClass:"now-playing-bar__left pr-0",attrs:{lg:"3"}},[e("v-hover",{scopedSlots:t._u([{key:"default",fn:function(i){var n=i.hover;return[e("v-card",{staticClass:"playing-cover-card",attrs:{img:t.albumPicUrl,"max-height":"50","max-width":"50","min-width":"50","min-height":"50"}},[e("v-fade-transition",[e("v-overlay",{attrs:{value:n,absolute:""}},[e("v-card-actions",[e("v-btn",{attrs:{icon:""},on:{click:function(i){t.showMusic=!t.showMusic}}},[e("v-icon",{attrs:{color:"pink"}},[t._v(" "+t._s(t.icon.mdiArrowExpand)+" ")])],1)],1)],1)],1)],1)]}}])}),e("div",{staticClass:"song-info"},[e("a",[e("span",{staticClass:"song-name",attrs:{title:t.song.name+" - "+t.$$(t.song,"ar","0","name")}},[t._v(" "+t._s(t.song.name)+" - "+t._s(t.$$(t.song,"ar","0","name"))+" ")])])])],1),e("v-col",{staticClass:"now-playing-bar__center pb-0",attrs:{lg:"6"}},[e("div",{staticClass:"playing-control"},[e("div",{staticClass:"playing-control-buttons"},[e("v-btn",{attrs:{icon:"",text:"",color:"#f9223b"}},[e("v-icon",{attrs:{small:""}},[t._v(" "+t._s(t.icon.mdiHeart)+" ")])],1),e("v-btn",{attrs:{icon:"",text:"",color:"purple"},on:{click:t.playPrev}},[e("v-icon",{attrs:{small:""}},[t._v(" "+t._s(t.icon.mdiSkipPrevious)+" ")])],1),e("v-btn",{attrs:{icon:"",text:"",color:"blue"},on:{click:t.playPause}},[e("v-icon",{attrs:{"x-large":""}},[t._v(" "+t._s(t.playing?t.icon.mdiPauseCircle:t.icon.mdiPlayCircle)+" ")])],1),e("v-btn",{attrs:{icon:"",text:"",color:"green"},on:{click:t.playNext}},[e("v-icon",{attrs:{small:""}},[t._v(" "+t._s(t.icon.mdiSkipNext)+" ")])],1),e("v-btn",{attrs:{icon:"",text:"",color:"blue"},on:{click:t.playOrder}},[e("v-icon",{attrs:{small:""}},[t._v(" "+t._s(t.orderIconState)+" ")])],1)],1),e("div",{staticClass:"playing-control-slider"},[e("div",{staticClass:"playing-time mr-1"},[e("span",[t._v(t._s(t._f("formatDuring")(t.playTime)))])]),e("v-slider",{attrs:{dense:"","hide-details":"",max:t.song.dt,min:"0",color:"#de7a7b","track-fill-color":"#de7a7b"},on:{start:t.handleChangeTimeStart,change:t.handleSlideChange},model:{value:t.playTime,callback:function(i){t.playTime=i},expression:"playTime"}}),e("div",{staticClass:"playing-time ml-1"},[e("span",[t._v(t._s(t._f("formatDuring")(t.song.dt)))])])],1)])]),e("v-col",{staticClass:"now-playing-bar__right",attrs:{lg:"3"}},[e("div",{staticClass:"ExtraControls"},[e("div",{staticClass:"volume-bar d-flex align-center"},[e("v-btn",{attrs:{icon:"",text:"",color:"blue"},on:{click:t.toggleVolume}},[e("v-icon",{attrs:{small:""}},[t._v(" "+t._s(t.volumeIconState)+" ")])],1),e("v-slider",{attrs:{dense:"","hide-details":"",max:1,min:"0",step:"0.01"},model:{value:t.volume,callback:function(i){t.volume=i},expression:"volume"}})],1),e("v-btn",{attrs:{icon:"",text:"",color:"blue"},on:{click:t.toggleWaitList}},[e("v-icon",{attrs:{small:""}},[t._v(" "+t._s(t.icon.mdiPlaylistMusic)+" ")])],1)],1)])],1),e("v-expand-transition",[e("v-sheet",{directives:[{name:"show",rawName:"v-show",value:t.showMusic,expression:"showMusic"}],staticClass:"musicStation"},[e("play-content",{attrs:{song:t.song},on:{close:t.closeMusic}})],1)],1),e("audio",{ref:"audio",attrs:{src:t.musicUrl},on:{ended:t.playNext,canplaythrough:t.onCanPlayThrough}},[t._v(" Your browser does not support the "),e("code",[t._v("audio")]),t._v(" element. ")])],1)},a=[],s=(e("c740"),e("d81d"),e("b0c0"),e("3835")),o=e("ade3"),l=e("5530"),r=e("2f62"),c=e("94ed"),u=e("d4ec"),d=e("bee2"),m=e("5b98"),v=function(){function t(i){Object(u["a"])(this,t),this.element=i}return Object(d["a"])(t,[{key:"play",value:function(){4===this.element.readyState?this.element.play():m["a"].warning("歌曲未准备好，无法播放")}},{key:"pause",value:function(){this.element.pause()}}]),t}(),h=function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("v-sheet",{staticClass:"frame"},[e("div",{staticClass:"frame-header",on:{click:t.close}}),e("v-row",{staticClass:"frame-content"},[e("v-col",{staticClass:"d-flex flex-column justify-center align-center frame-content-left pa-0",attrs:{lg:"5"}},[e("v-card",{staticClass:"rounded-xl album-cover",attrs:{"max-height":"350",elevation:"0"}},[e("v-img",{attrs:{src:t.albumPicUrl,"max-height":"350","max-width":"350"}})],1),e("div",{staticClass:"control_bar d-flex flex-column"},[e("div",{staticClass:"song-info d-flex justify-space-between"},[e("div",{staticClass:"left d-flex flex-column"},[e("span",{staticClass:"white--text text-subtitle-2"},[t._v(t._s(t.song.name))]),e("span",{staticClass:"white--text text-subtitle-1"},[t._v(t._s(t.$$(t.song,"ar","0","name")))])]),e("div",{staticClass:"right d-flex align-center"},[e("v-btn",{attrs:{icon:"",color:"pink"}},[e("v-icon",{attrs:{color:"white"}},[t._v(" "+t._s(t.icon.mdiDotsHorizontal)+" ")])],1)],1)]),e("div",{staticClass:"control_process"},[e("v-slider",{attrs:{max:"100",min:"0",color:"white","thumb-color":"white","track-fill-color":"white","track-color":"white"}})],1),e("div",{staticClass:"control_btns d-flex"},t._l(t.controlBtns,(function(i){return e("v-btn",{key:i.val,attrs:{icon:"",text:"",color:"white"}},[e("v-icon",{attrs:{size:i.size}},[t._v(" "+t._s(i.icon)+" ")])],1)})),1)])],1),e("v-col",{staticClass:"frame-content-right pa-0",attrs:{lg:"7"}},[e("div",{staticClass:"frame-lyrics"},[t.lyric.length?t._l(t.lyric,(function(i){return e("div",{key:i.time},[t._v(" "+t._s(i.sentence)+" ")])})):e("div",[t._v(" 暂无歌词 ")])],2)]),e("div",{staticClass:"frame-bg"},[e("v-img",{staticClass:"bg-color album-artwork",attrs:{src:t.$$(t.song,"al","picUrl")}}),e("v-img",{staticClass:"bg-black album-artwork",attrs:{src:t.$$(t.song,"al","picUrl")}})],1)],1)],1)},p=[],f={name:"PlayContent",props:{song:{type:Object,default:function(){return{}}}},data:function(){return{icon:{mdiDotsHorizontal:c["t"]},controlBtns:[{val:1,icon:c["bb"],size:"24"},{val:2,size:"34",icon:c["P"]},{val:3,size:"24",icon:c["ab"]}]}},computed:{albumPicUrl:function(){var t;return"".concat(null===(t=this.song.al)||void 0===t?void 0:t.picUrl,"?param=400y400")},lyric:function(){var t;return null!==(t=this.song.lyric)&&void 0!==t?t:[]}},methods:{close:function(){this.$emit("close")}}},g=f,y=(e("81d8"),e("2877")),b=e("6544"),_=e.n(b),x=e("8336"),C=e("b0af"),w=e("62ad"),P=e("132d"),T=e("adda"),k=e("0fd9"),E=e("8dd9"),S=e("ba0d"),M=Object(y["a"])(g,h,p,!1,null,null,null),L=M.exports;_()(M,{VBtn:x["a"],VCard:C["a"],VCol:w["a"],VIcon:P["a"],VImg:T["a"],VRow:k["a"],VSheet:E["a"],VSlider:S["a"]});var I=1,O={ORDER:0,CYCLE:1,SINGLE_CYCLE:2,RANDOM:3},V={components:{PlayContent:L},data:function(){return{icon:{mdiHeart:c["x"],mdiSkipPrevious:c["bb"],mdiSkipNext:c["ab"],mdiPlayCircle:c["R"],mdiPauseCircle:c["P"],mdiPlaylistMusic:c["S"],mdiArrowExpand:c["e"]},player:{},interval:null,playTime:0,volume:1,prevVolume:1,playMode:O.ORDER,showMusic:!1}},computed:Object(l["a"])(Object(l["a"])({},Object(r["b"])({song:function(t){return t.music.song},musicUrl:function(t){return t.music.musicUrl},playing:function(t){return t.music.playing},pendingList:function(t){return t.music.pendingList},currentTime:function(t){return t.music.currentTime},showList:function(t){return t.music.showList}})),{},{songIndex:function(){var t=this;return this.pendingList.findIndex((function(i){return i.id===t.song.id}))},next:function(){return this.pendingList[this.songIndex+1===this.pendingList.length?0:this.songIndex+1]},prev:function(){return this.pendingList[0===this.songIndex?this.pendingList.length-1:this.songIndex-1]},volumeIconState:function(){return 0===this.volume?c["ob"]:this.volume>0&&this.volume<=.4?c["mb"]:this.volume>.4&&this.volume<=.7?c["nb"]:c["lb"]},orderIconState:function(){var t;return(t={},Object(o["a"])(t,O.ORDER,c["X"]),Object(o["a"])(t,O.CYCLE,c["Y"]),Object(o["a"])(t,O.SINGLE_CYCLE,c["Z"]),Object(o["a"])(t,O.RANDOM,c["N"]),t)[this.playMode]},albumPicUrl:function(){var t;return this.song.al?"".concat(null===(t=this.song.al)||void 0===t?void 0:t.picUrl,"?param=200y200"):""}}),watch:{playing:function(t){var i=this;this.$nextTick((function(){t?(i.setPlayTime(),i.player.play()):(clearInterval(i.interval),i.player.pause())}))},currentTime:function(t){this.playTime=t},volume:function(t){this.player.element.volume=t},song:function(){this.initMediaSession()}},mounted:function(){this.player=new v(this.$refs.audio)},methods:{playPause:function(){this.$store.commit("music/UPDATE_PLAYER",{playing:!this.playing})},playNext:function(){var t,i=this.next.id,e=this.pendingList.length;this.playMode===O.RANDOM?i=null===(t=this.pendingList[Math.floor(Math.random()*e)])||void 0===t?void 0:t.id:this.playMode===O.SINGLE_CYCLE?this.rePlay():this.playMode===O.ORDER&&this.songIndex===e-1?this.$store.commit("music/UPDATE_PLAYER",{currentTime:0,playing:!1}):this.$store.dispatch("music/startNewMusic",i)},playPrev:function(){this.$store.dispatch("music/startNewMusic",this.prev.id)},rePlay:function(){this.handleSlideChange(0)},onCanPlayThrough:function(){console.log("already can play"),this.$store.commit("music/UPDATE_PLAYER",{playing:!0})},setPlayTime:function(){var t=this;this.interval=setInterval((function(){t.$store.commit("music/UPDATE_PLAYER",{currentTime:1e3*t.player.element.currentTime})}),500)},stopPlayTime:function(){clearInterval(this.interval)},handleChangeTimeStart:function(){console.log("slider move start"),this.stopPlayTime()},handleSlideChange:function(t){console.log("slider change end"),this.player.element.currentTime=t/1e3,this.$store.commit("music/UPDATE_PLAYER",{currentTime:t}),this.playing&&this.setPlayTime()},toggleVolume:function(){0===this.volume?this.volume=I:(I=this.volume,this.volume=0)},playOrder:function(){this.playMode<3?this.playMode++:this.playMode=0},toggleWaitList:function(){this.$store.commit("music/UPDATE_WAIT_LIST",!this.showList)},initMediaSession:function(){var t,i,e;"mediaSession"in navigator&&(navigator.mediaSession.metadata=new MediaMetadata({title:this.song.name,artist:null===(t=this.song.ar)||void 0===t||null===(i=t[0])||void 0===i?void 0:i.name,album:null===(e=this.song.al)||void 0===e?void 0:e.name,artwork:[{src:this.albumPicUrl,sizes:"512x512",type:"image/png"}]}),[["play",this.playPause],["pause",this.playPause],["previoustrack",this.playPrev],["nexttrack",this.playNext]].map((function(t){var i=Object(s["a"])(t,2),e=i[0],n=i[1];return navigator.mediaSession.setActionHandler(e,n)})))},closeMusic:function(){this.showMusic=!1}}},$=V,A=(e("74f1"),e("99d9")),R=e("0789"),U=e("ce87"),j=e("a797"),D=Object(y["a"])($,n,a,!1,null,"54504204",null);i["default"]=D.exports;_()(D,{VBtn:x["a"],VCard:C["a"],VCardActions:A["a"],VCol:w["a"],VExpandTransition:R["a"],VFadeTransition:R["c"],VHover:U["a"],VIcon:P["a"],VOverlay:j["a"],VRow:k["a"],VSheet:E["a"],VSlider:S["a"]})},bee2:function(t,i,e){"use strict";function n(t,i){for(var e=0;e<i.length;e++){var n=i[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,i,e){return i&&n(t.prototype,i),e&&n(t,e),t}e.d(i,"a",(function(){return a}))},c2dd:function(t,i,e){},c740:function(t,i,e){"use strict";var n=e("23e7"),a=e("b727").findIndex,s=e("44d2"),o=e("ae40"),l="findIndex",r=!0,c=o(l);l in[]&&Array(1)[l]((function(){r=!1})),n({target:"Array",proto:!0,forced:r||!c},{findIndex:function(t){return a(this,t,arguments.length>1?arguments[1]:void 0)}}),s(l)},d4ec:function(t,i,e){"use strict";function n(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}e.d(i,"a",(function(){return n}))}}]);
//# sourceMappingURL=page7.c2221e68.js.map